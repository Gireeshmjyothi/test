@Transactional
    @Modifying
    @Query(value = """
            UPDATE GST_REPORT_DETAILS
            SET GST_PROCESSING_STATUS = :gstnProcessingStatus
            WHERE GSTN || '|' || MONTH_YEAR
            IN (:pairs) AND GST_PROCESSING_STATUS = :gstPendingStatus
            """, nativeQuery = true)
    void updateGstProcessingStatusByGstnAndMonthYear(@Param("pairs") List<String> pairs, @Param("gstnProcessingStatus") String gstSuccessStatus, String gstPendingStatus);


private List<String> getGstnCsvReportRowList(List<GstnCsvReportDto> gstnCsvReportDtoList) {
        return gstnCsvReportDtoList
                .stream()
                .filter(filter -> ObjectUtils.isNotEmpty(filter.getGstn()) && ObjectUtils.isNotEmpty(filter.getMonthYear()))
                .map(gstnCsvReportDto -> gstnCsvReportDto.getGstn() + "|" + gstnCsvReportDto.getMonthYear())
                .toList();
    }
