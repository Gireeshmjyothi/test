package com.epay.reporting.validator;

import com.epay.reporting.model.request.OtpGenerationRequest;
import com.sbi.epay.logging.utility.LoggerFactoryUtility;
import com.sbi.epay.logging.utility.LoggerUtility;
import org.springframework.stereotype.Component;

import java.util.ArrayList;

import static com.epay.reporting.util.ReportingConstant.MOBILE_NUMBER_REGEX;

@Component
public class OtpValidator extends BaseValidator {
    private final LoggerUtility logger = LoggerFactoryUtility.getLogger(this.getClass());

    public void validateOtpGeneration(OtpGenerationRequest generationRequest) {

        //TODO-captcha validation
        logger.info("Validating otp generation request.");
        errorDtoList = new ArrayList<>();
        checkMandatoryField(generationRequest.getMobileNumber(), "mobileNumber");
        checkMandatoryField(generationRequest.getRequestId(), "requestId");
        checkMandatoryField(generationRequest.getRequestType(), "requestType");
        throwIfErrors();

        checkForLeadingTrailingAndSingleSpace(generationRequest.getMobileNumber(), "mobileNumber");
        checkForLeadingTrailingAndSingleSpace(generationRequest.getRequestId(), "requestId");
        checkForLeadingTrailingAndSingleSpace(generationRequest.getRequestType(), "requestType");
        throwIfErrors();

        validateFieldWithRegex(generationRequest.getMobileNumber(), MOBILE_NUMBER_REGEX, "mobileNumber", "Mobile number contains [1-9]");
        throwIfErrors();
        logger.info("Otp generation request validated successfully.");
    }

}
